<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RPAS-Field comparison - Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">RPAS-Field comparison</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./analysis.html" aria-current="page">Analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./prepare_data.html">Data</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/serpam/rpasveg_alcontar"><i class="bi bi-github" role="img" aria-label="GitHub repo">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/SERPAM_EEZ"><i class="bi bi-twitter" role="img" aria-label="SERPAM Twitter">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#aims" id="toc-aims" class="nav-link active" data-scroll-target="#aims">Aims</a></li>
  <li><a href="#general-correlation" id="toc-general-correlation" class="nav-link" data-scroll-target="#general-correlation">General correlation</a></li>
  <li><a href="#comparison-by-treatments" id="toc-comparison-by-treatments" class="nav-link" data-scroll-target="#comparison-by-treatments">Comparison by treatments</a></li>
  <li><a href="#comparison-by-cover-types" id="toc-comparison-by-cover-types" class="nav-link" data-scroll-target="#comparison-by-cover-types">Comparison by cover types</a></li>
  <li><a href="#variance-partitioning" id="toc-variance-partitioning" class="nav-link" data-scroll-target="#variance-partitioning">Variance partitioning</a>
  <ul class="collapse">
  <li><a href="#find-the-optimous-complexity-parameter" id="toc-find-the-optimous-complexity-parameter" class="nav-link" data-scroll-target="#find-the-optimous-complexity-parameter">Find the optimous complexity parameter</a></li>
  </ul></li>
  <li><a href="#is-the-the-estimation-influenced-by-other-variables" id="toc-is-the-the-estimation-influenced-by-other-variables" class="nav-link" data-scroll-target="#is-the-the-estimation-influenced-by-other-variables">Is the the estimation influenced by other variables?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"scripts/99-pkgs.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/rpasfield_alcontar.xlsx"</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"alcontar"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cover_type =</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(cover_type <span class="sc">==</span> <span class="st">"Medium-cover shrubland"</span> <span class="sc">~</span> <span class="st">"Moderate-cover shrubland"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">TRUE</span> <span class="sc">~</span> cover_type</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="aims" class="level2">
<h2 class="anchored" data-anchor-id="aims">Aims</h2>
</section>
<section id="general-correlation" class="level2">
<h2 class="anchored" data-anchor-id="general-correlation">General correlation</h2>
<ul>
<li><p>Explore the correlation between plant cover estimated by RPAS (RPAS-estimated vegetation cover) and estimated by field measures (Field-estimated vegetation cover)</p></li>
<li><p>Compute the RMSE (Root Mean Squared Error) and the normalized RMSE</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.rmse_global <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.rmse_global <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;"><caption>RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS vs Field measures</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> RMSE </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> norm. RMSE (%) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 9.89 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 12.21 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<ul>
<li>Compute the LM and the PRESS statistics. More info <a href="https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/">here</a>.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>Estimates of the regression between RPAS and Field measurement</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> term </th>
   <th style="text-align:right;"> estimate </th>
   <th style="text-align:right;"> std.error </th>
   <th style="text-align:right;"> statistic </th>
   <th style="text-align:right;"> p.value </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> -2.868642 </td>
   <td style="text-align:right;"> 1.8882404 </td>
   <td style="text-align:right;"> -1.519214 </td>
   <td style="text-align:right;"> 0.132065 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> plant_coverage_field </td>
   <td style="text-align:right;"> 1.124453 </td>
   <td style="text-align:right;"> 0.0537794 </td>
   <td style="text-align:right;"> 20.908615 </td>
   <td style="text-align:right;"> 0.000000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td style="text-align:left;"> r.squared </td>
   <td style="text-align:right;"> 0.8230322 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> adj.r.squared </td>
   <td style="text-align:right;"> 0.8211496 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma </td>
   <td style="text-align:right;"> 9.6840794 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> statistic </td>
   <td style="text-align:right;"> 437.1701925 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> p.value </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> df </td>
   <td style="text-align:right;"> 1.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> logLik </td>
   <td style="text-align:right;"> -353.1739261 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> AIC </td>
   <td style="text-align:right;"> 712.3478521 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BIC </td>
   <td style="text-align:right;"> 720.0408967 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> deviance </td>
   <td style="text-align:right;"> 8815.4509553 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> df.residual </td>
   <td style="text-align:right;"> 94.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nobs </td>
   <td style="text-align:right;"> 96.0000000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>The p-value of the regression is 4.0417611^{-37}.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://fhernanb.github.io/libro_regresion/diag2.html#estad%C3%ADstica-press-y-r2-de-predicci%C3%B3n</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://rpubs.com/RatherBit/102428</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>PRESS <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the predictive residuals</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(linear.model) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">lm.influence</span>(linear.model)<span class="sc">$</span>hat)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the PRESS</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  PRESS <span class="ot">&lt;-</span> <span class="fu">sum</span>(pr<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(PRESS)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>pred_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Use anova() to get the sum of squares for the linear model</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  lm.anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(linear.model)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Calculate the total sum of squares</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  tss <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm.anova<span class="sc">$</span><span class="st">"Sum Sq"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the predictive R^2</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  pred.r.squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">PRESS</span>(linear.model) <span class="sc">/</span> (tss)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pred.r.squared)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9127.115</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pred_r_squared</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8167757</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/17022553/adding-r2-on-graph-with-facets</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>lm_r2 <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, df)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    r2,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">format</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>r.squared, <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="fu">as.expression</span>(eq))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_eqn = function(df, model){</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   eq &lt;- substitute(</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     italic(y) == a + b %.% italic(x) * "," ~  ~pvalue~p,</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#      list(</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#         a = format(coef(model)[1], digits = 3),</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#         b = format(coef(model)[2], digits = 3),</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#         p = ifelse(</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#           summary(m)$coefficients[2,'Pr(&gt;|t|)'] &lt; 0.0001,</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#           "&lt; 0.0001",</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#           "= ~format(summary(m)$coefficients[2,'Pr(&gt;|t|)'])"</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.character(as.expression(eq))</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>verde_claro <span class="ot">&lt;-</span> <span class="st">"#c6ddb3"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>verde_oscuro <span class="ot">&lt;-</span> <span class="st">"#3e6c62"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ylab <span class="ot">&lt;-</span> <span class="st">"Drone-estimated"</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>xlab <span class="ot">&lt;-</span> <span class="st">"Field-estimated"</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># See https://stackoverflow.com/questions/65076492/ggplot-size-of-annotate-vs-size-of-element-text</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom theme</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>theme_rpas <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For panels</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> x</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>general_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> xlab, <span class="at">y =</span> ylab,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(eq.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">85</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"RMSE = "</span>, <span class="fu">round</span>(df.rmse_global<span class="sc">$</span>rmse, <span class="dv">2</span>)),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span> <span class="sc">/</span> .pt,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">75</span>,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"italic(R)[predic.]^2~'='~"</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">pred_r_squared</span>(m), <span class="dv">3</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span> <span class="sc">/</span> .pt,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>general_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparison-by-treatments" class="level2">
<h2 class="anchored" data-anchor-id="comparison-by-treatments">Comparison by treatments</h2>
<ul>
<li>Is the estimation different between treatments?</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="ot">&lt;-</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  df.rmse_treatment <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">pred_r_squared</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x))))</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;"><caption>RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS vs Field measures. Values by treatment</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Treatment </th>
   <th style="text-align:right;"> RMSE </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> norm. RMSE (%) </th>
   <th style="text-align:right;"> pred R2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Prescribed Burn </td>
   <td style="text-align:right;"> 7.95 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 66 </td>
   <td style="text-align:right;"> 13.95 </td>
   <td style="text-align:right;"> 0.748 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pyric Herbivorism </td>
   <td style="text-align:right;"> 10.73 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 13.24 </td>
   <td style="text-align:right;"> 0.832 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>eqns <span class="ot">&lt;-</span> <span class="fu">by</span>(df, df<span class="sc">$</span>treatment, lm_r2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df.label <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eq =</span> <span class="fu">unclass</span>(eqns), <span class="at">treatment =</span> <span class="fu">names</span>(eqns))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df.label<span class="sc">$</span>lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(df.label<span class="sc">$</span>treatment, <span class="st">"R^2 ="</span>, df.label<span class="sc">$</span>eq, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>r2_labeller <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, value) {</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df.label<span class="sc">$</span>lab)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>treatment_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment, <span class="at">labeller =</span> label_value) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylab, <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_treatment, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">80</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RMSE&lt;sub&gt;norm.&lt;/sub&gt; = "</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(rmsen.minmax, <span class="dv">2</span>), <span class="st">" %"</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_treatment, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">70</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*R*&lt;sup&gt;2&lt;/sup&gt;&lt;sub&gt;predic.&lt;/sub&gt; = "</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(pred.r2, <span class="dv">3</span>)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>treatment_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparison-by-cover-types" class="level2">
<h2 class="anchored" data-anchor-id="comparison-by-cover-types">Comparison by cover types</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cover_type) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="ot">&lt;-</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  df.rmse_groups <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(cover_type) <span class="sc">|&gt;</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">abs</span>(<span class="fu">pred_r_squared</span>(</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x)))))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Cover type"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;"><caption>RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS vs Field measures. Values by cover types</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Cover type </th>
   <th style="text-align:right;"> RMSE </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> norm. RMSE (%) </th>
   <th style="text-align:right;"> pred R2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> High-cover alfa grass steppe </td>
   <td style="text-align:right;"> 7.63 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 9.78 </td>
   <td style="text-align:right;"> 0.938 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> High-cover shrubland </td>
   <td style="text-align:right;"> 12.69 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 61 </td>
   <td style="text-align:right;"> 24.89 </td>
   <td style="text-align:right;"> 0.571 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Low-cover shrubland </td>
   <td style="text-align:right;"> 7.30 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 33.18 </td>
   <td style="text-align:right;"> 0.145 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Moderate-cover shrubland </td>
   <td style="text-align:right;"> 10.89 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 20.16 </td>
   <td style="text-align:right;"> 0.469 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>eqns <span class="ot">&lt;-</span> <span class="fu">by</span>(df, df<span class="sc">$</span>cover_type, lm_r2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df.label <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eq =</span> <span class="fu">unclass</span>(eqns), <span class="at">treatment =</span> <span class="fu">names</span>(eqns))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df.label<span class="sc">$</span>lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(df.label<span class="sc">$</span>cover_type, <span class="st">"R^2 ="</span>, df.label<span class="sc">$</span>eq, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>r2_labeller <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, value) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df.label<span class="sc">$</span>lab)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>custom_order <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Low-cover shrubland"</span>, <span class="st">"Moderate-cover shrubland"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High-cover shrubland"</span>, <span class="st">"High-cover alfa grass steppe"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>covertype_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(cover_type, custom_order),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> label_value</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylab, <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_groups, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">80</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RMSE&lt;sub&gt;norm.&lt;/sub&gt; = "</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(rmsen.minmax, <span class="dv">2</span>), <span class="st">" %"</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_groups, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">70</span>,</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*R*&lt;sup&gt;2&lt;/sup&gt;&lt;sub&gt;predic.&lt;/sub&gt; = "</span>,</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(pred.r2, <span class="dv">3</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>covertype_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> covertype_plot <span class="sc">/</span> treatment_plot <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="sc">&amp;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="variance-partitioning" class="level2">
<h2 class="anchored" data-anchor-id="variance-partitioning">Variance partitioning</h2>
<p>Is the relationship between the vegetation coverage estimated by RPAS and by field measurement uniform across all coverage values? or is the correlation between those two approach homogeneous across all coverage values?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> partykit<span class="sc">::</span><span class="fu">ctree</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model formula:
plant_coverage_rpas ~ plant_coverage_field

Fitted party:
[1] root
|   [2] plant_coverage_field &lt;= 36
|   |   [3] plant_coverage_field &lt;= 23
|   |   |   [4] plant_coverage_field &lt;= 13: 9.150 (n = 16, err = 498.4)
|   |   |   [5] plant_coverage_field &gt; 13: 17.207 (n = 28, err = 2433.9)
|   |   [6] plant_coverage_field &gt; 23: 28.322 (n = 26, err = 2998.9)
|   [7] plant_coverage_field &gt; 36
|   |   [8] plant_coverage_field &lt;= 50: 48.571 (n = 11, err = 1550.7)
|   |   [9] plant_coverage_field &gt; 50: 70.347 (n = 15, err = 2566.3)

Number of inner nodes:    4
Number of terminal nodes: 5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sctest</span>(ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`
          plant_coverage_field
statistic         7.818806e+01
p.value           9.368296e-19

$`2`
          plant_coverage_field
statistic         2.791016e+01
p.value           1.270809e-07

$`3`
          plant_coverage_field
statistic           5.75223821
p.value             0.01646766

$`4`
NULL

$`5`
          plant_coverage_field
statistic            0.1017646
p.value              0.7497222

$`6`
          plant_coverage_field
statistic           2.83932243
p.value             0.09198299

$`7`
          plant_coverage_field
statistic         1.604824e+01
p.value           6.174895e-05

$`8`
NULL

$`9`
NULL</code></pre>
</div>
</div>
<p>There are 5 terminal nodes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparty</span>(ct) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_label</span>(<span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_plot</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gglist =</span> <span class="fu">list</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas), <span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"gray"</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"fixed"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_axis_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_separator =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"terminal"</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">col =</span> splitvar),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_list =</span> <span class="fu">list</span>(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Node"</span>, id)),</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> splitvar),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">accuracy =</span> <span class="fl">0.001</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimal.mark =</span> <span class="st">"."</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_p =</span> <span class="cn">TRUE</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_gpar =</span> <span class="fu">list</span>(</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"inner"</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Node "</span>, id, <span class="st">", (n= "</span>, nodesize, <span class="st">")"</span>)),</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"terminal"</span>,</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="fl">0.01</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about the overfitting?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">13</span>)),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">23</span>)),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">23</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">36</span>)),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">36</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">50</span>)),</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">50</span>)),</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="find-the-optimous-complexity-parameter" class="level3">
<h3 class="anchored" data-anchor-id="find-the-optimous-complexity-parameter">Find the optimous complexity parameter</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ctrpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ctrpart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>n= 96 

node), split, n, deviance, yval
      * denotes terminal node

 1) root 96 49813.8800 30.77125  
   2) plant_coverage_field&lt; 36.5 70  9815.7370 19.49371  
     4) plant_coverage_field&lt; 23.5 44  3593.3100 14.27727  
       8) plant_coverage_field&lt; 13.5 16   498.4016  9.15000 *
       9) plant_coverage_field&gt;=13.5 28  2433.9300 17.20714 *
     5) plant_coverage_field&gt;=23.5 26  2998.9390 28.32154  
      10) plant_coverage_field&lt; 30.5 16   998.4559 23.88250 *
      11) plant_coverage_field&gt;=30.5 10  1180.7530 35.42400 *
   3) plant_coverage_field&gt;=36.5 26  7126.2780 61.13385  
     6) plant_coverage_field&lt; 51 11  1550.7140 48.57091 *
     7) plant_coverage_field&gt;=51 15  2566.3220 70.34667 *</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(ctrpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = plant_coverage_rpas ~ plant_coverage_field, data = df)

Variables actually used in tree construction:
[1] plant_coverage_field

Root node error: 49814/96 = 518.89

n= 96 

        CP nsplit rel error  xerror     xstd
1 0.659894      0   1.00000 1.02767 0.147971
2 0.064711      1   0.34011 0.39621 0.065669
3 0.060410      2   0.27540 0.38907 0.061846
4 0.016456      3   0.21499 0.29072 0.047114
5 0.013269      4   0.19853 0.28587 0.046682
6 0.010000      5   0.18526 0.26769 0.046179</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(ctrpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ctrpart2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df, <span class="at">control =</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> .<span class="dv">075</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>ctrpart2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>n= 96 

node), split, n, deviance, yval
      * denotes terminal node

1) root 96 49813.880 30.77125  
  2) plant_coverage_field&lt; 36.5 70  9815.737 19.49371 *
  3) plant_coverage_field&gt;=36.5 26  7126.278 61.13385 *</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(ctrpart2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = plant_coverage_rpas ~ plant_coverage_field, data = df, 
    control = rpart.control(minsplit = 2, cp = 0.075))

Variables actually used in tree construction:
[1] plant_coverage_field

Root node error: 49814/96 = 518.89

n= 96 

       CP nsplit rel error  xerror     xstd
1 0.65989      0   1.00000 1.02767 0.147971
2 0.07500      1   0.34011 0.39621 0.065669</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(ctrpart2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ct_ok <span class="ot">&lt;-</span> partykit<span class="sc">::</span><span class="fu">ctree</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ctree_control</span>(<span class="at">minsplit =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">maxdepth =</span> <span class="dv">1</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>plot_party <span class="ot">&lt;-</span> <span class="fu">ggparty</span>(ct_ok) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge</span>() <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_label</span>(<span class="at">colour =</span> verde_oscuro, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_plot</span>(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">gglist =</span> <span class="fu">list</span>(</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> plant_coverage_field,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> plant_coverage_rpas</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"gray"</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro),</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>),</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"fixed"</span>,</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_axis_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_separator =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"terminal"</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">col =</span> splitvar),</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_list =</span> <span class="fu">list</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(id),</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">"Vegetation cover"</span>),</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">accuracy =</span> <span class="fl">0.001</span>,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimal.mark =</span> <span class="st">"."</span>,</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_p =</span> <span class="cn">TRUE</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_gpar =</span> <span class="fu">list</span>(</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>),</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>),</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"inner"</span>,</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.col =</span> verde_oscuro</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"n = "</span>, nodesize)),</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"terminal"</span>,</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="fl">0.01</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>plot_party</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cover_vp =</span> <span class="fu">case_when</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">36</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="st">"cob_low"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"cob_high"</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cover_vp) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="ot">&lt;-</span> </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  df.rmse_vp <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(cover_vp) <span class="sc">|&gt;</span> </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">abs</span>(<span class="fu">pred_r_squared</span>(</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x)))))</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Groups Variance partitioning"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;"><caption>RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS vs Field measures. Values by variance partitioning-groups.</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Groups Variance partitioning </th>
   <th style="text-align:right;"> RMSE </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> norm. RMSE (%) </th>
   <th style="text-align:right;"> pred R2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> cob_high </td>
   <td style="text-align:right;"> 11.53 </td>
   <td style="text-align:right;"> 37 </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 23.07 </td>
   <td style="text-align:right;"> 0.595 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cob_low </td>
   <td style="text-align:right;"> 9.20 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 30.68 </td>
   <td style="text-align:right;"> 0.370 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="is-the-the-estimation-influenced-by-other-variables" class="level1">
<h1>Is the the estimation influenced by other variables?</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">add_residuals</span>(m) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid.abs =</span> <span class="fu">abs</span>(resid))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>dfres <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abs.Shannon =</span> <span class="fu">abs</span>(shannon)) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon =</span> abs.Shannon,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Richness =</span> richness, <span class="at">Slope =</span> slope, resid, resid.abs</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Shannon"</span>, <span class="st">"Richness"</span>, <span class="st">"Slope"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">fct_relevel</span>(name, <span class="fu">c</span>(<span class="st">"Shannon"</span>, <span class="st">"Richness"</span>, <span class="st">"Slope"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggscatter</span>(dfres,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"value"</span>, <span class="at">y =</span> <span class="st">"resid.abs"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> verde_oscuro,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"|"</span>, <span class="st">"Residuals"</span>, <span class="st">"|"</span>)),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">"reg.line"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> verde_oscuro, <span class="at">fill =</span> verde_claro),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.by =</span> <span class="st">"variable"</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y.npc =</span> <span class="st">"top"</span>, <span class="at">label.x.npc =</span> <span class="st">"left"</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> verde_oscuro, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> verde_oscuro,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> verde_oscuro,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>p.resid <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">facet</span>(p,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.by =</span> <span class="st">"variable"</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.labs.background =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>p.resid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analysis"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> grateful-refs.bib</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"scripts/99-pkgs.R"</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/rpasfield_alcontar.xlsx"</span>),</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"alcontar"</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cover_type =</span> </span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(cover_type <span class="sc">==</span> <span class="st">"Medium-cover shrubland"</span> <span class="sc">~</span> <span class="st">"Moderate-cover shrubland"</span>,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">TRUE</span> <span class="sc">~</span> cover_type</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aims</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## General correlation</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explore the correlation between plant cover estimated by RPAS (RPAS-estimated vegetation cover) and estimated by field measures (Field-estimated vegetation cover)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compute the RMSE (Root Mean Squared Error) and the normalized RMSE</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rmse-global</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>df.rmse_global <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tab-rmse-global</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS *vs* Field measures</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>df.rmse_global <span class="sc">%&gt;%</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>),</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compute the LM and the PRESS statistics. More info <span class="co">[</span><span class="ot">here</span><span class="co">](https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/)</span>.</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tab-lm-global</span></span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Estimates of the regression between RPAS and Field measurement</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>The p-value of the regression is <span class="in">`r broom::glance(m)$p.value`</span>.</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: press-computation</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a><span class="co"># https://fhernanb.github.io/libro_regresion/diag2.html#estad%C3%ADstica-press-y-r2-de-predicci%C3%B3n</span></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="co"># https://rpubs.com/RatherBit/102428</span></span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="co"># https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/</span></span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>PRESS <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the predictive residuals</span></span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(linear.model) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">lm.influence</span>(linear.model)<span class="sc">$</span>hat)</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the PRESS</span></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>  PRESS <span class="ot">&lt;-</span> <span class="fu">sum</span>(pr<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(PRESS)</span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>pred_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Use anova() to get the sum of squares for the linear model</span></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a>  lm.anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(linear.model)</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Calculate the total sum of squares</span></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>  tss <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm.anova<span class="sc">$</span><span class="st">"Sum Sq"</span>)</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the predictive R^2</span></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>  pred.r.squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">PRESS</span>(linear.model) <span class="sc">/</span> (tss)</span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pred.r.squared)</span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(m)</span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a><span class="fu">pred_r_squared</span>(m)</span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/17022553/adding-r2-on-graph-with-facets</span></span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>lm_r2 <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, df)</span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>  eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>    r2,</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">format</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>r.squared, <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="fu">as.expression</span>(eq))</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_eqn = function(df, model){</span></span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a><span class="co">#   eq &lt;- substitute(</span></span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a><span class="co">#     italic(y) == a + b %.% italic(x) * "," ~  ~pvalue~p,</span></span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a><span class="co">#      list(</span></span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="co">#         a = format(coef(model)[1], digits = 3),</span></span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a><span class="co">#         b = format(coef(model)[2], digits = 3),</span></span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a><span class="co">#         p = ifelse(</span></span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a><span class="co">#           summary(m)$coefficients[2,'Pr(&gt;|t|)'] &lt; 0.0001,</span></span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a><span class="co">#           "&lt; 0.0001",</span></span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a><span class="co">#           "= ~format(summary(m)$coefficients[2,'Pr(&gt;|t|)'])"</span></span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.character(as.expression(eq))</span></span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a>verde_claro <span class="ot">&lt;-</span> <span class="st">"#c6ddb3"</span></span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a>verde_oscuro <span class="ot">&lt;-</span> <span class="st">"#3e6c62"</span></span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a>ylab <span class="ot">&lt;-</span> <span class="st">"Drone-estimated"</span></span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a>xlab <span class="ot">&lt;-</span> <span class="st">"Field-estimated"</span></span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a><span class="co"># See https://stackoverflow.com/questions/65076492/ggplot-size-of-annotate-vs-size-of-element-text</span></span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom theme</span></span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a>theme_rpas <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For panels</span></span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>)</span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> x</span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a>general_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> xlab, <span class="at">y =</span> ylab,</span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span></span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(eq.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">85</span>,</span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"RMSE = "</span>, <span class="fu">round</span>(df.rmse_global<span class="sc">$</span>rmse, <span class="dv">2</span>)),</span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">75</span>,</span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>      <span class="st">"italic(R)[predic.]^2~'='~"</span>,</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">pred_r_squared</span>(m), <span class="dv">3</span>)</span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a>general_plot</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison by treatments</span></span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Is the estimation different between treatments?</span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rmse-treatment</span></span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="ot">&lt;-</span> </span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a>  df.rmse_treatment <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span> </span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">pred_r_squared</span>(</span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x))))</span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tab-rmse-treatment</span></span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS *vs* Field measures. Values by treatment</span></span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a>df.rmse_treatment <span class="sc">%&gt;%</span></span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a>eqns <span class="ot">&lt;-</span> <span class="fu">by</span>(df, df<span class="sc">$</span>treatment, lm_r2)</span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a>df.label <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eq =</span> <span class="fu">unclass</span>(eqns), <span class="at">treatment =</span> <span class="fu">names</span>(eqns))</span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a>df.label<span class="sc">$</span>lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(df.label<span class="sc">$</span>treatment, <span class="st">"R^2 ="</span>, df.label<span class="sc">$</span>eq, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a>r2_labeller <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, value) {</span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df.label<span class="sc">$</span>lab)</span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a>treatment_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment, <span class="at">labeller =</span> label_value) <span class="sc">+</span></span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylab, <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span>) <span class="sc">+</span></span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_treatment, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">80</span>,</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RMSE&lt;sub&gt;norm.&lt;/sub&gt; = "</span>,</span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(rmsen.minmax, <span class="dv">2</span>), <span class="st">" %"</span></span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_treatment, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">70</span>,</span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*R*&lt;sup&gt;2&lt;/sup&gt;&lt;sub&gt;predic.&lt;/sub&gt; = "</span>,</span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(pred.r2, <span class="dv">3</span>)</span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a>treatment_plot</span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison by cover types</span></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rmse-groups</span></span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cover_type) <span class="sc">%&gt;%</span></span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="ot">&lt;-</span> </span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a>  df.rmse_groups <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(cover_type) <span class="sc">|&gt;</span> </span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">abs</span>(<span class="fu">pred_r_squared</span>(</span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x)))))</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tab-rmse-groups</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS *vs* Field measures. Values by cover types</span></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a>df.rmse_groups <span class="sc">%&gt;%</span></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Cover type"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a>eqns <span class="ot">&lt;-</span> <span class="fu">by</span>(df, df<span class="sc">$</span>cover_type, lm_r2)</span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>df.label <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eq =</span> <span class="fu">unclass</span>(eqns), <span class="at">treatment =</span> <span class="fu">names</span>(eqns))</span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>df.label<span class="sc">$</span>lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(df.label<span class="sc">$</span>cover_type, <span class="st">"R^2 ="</span>, df.label<span class="sc">$</span>eq, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a>r2_labeller <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, value) {</span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df.label<span class="sc">$</span>lab)</span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>custom_order <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Low-cover shrubland"</span>, <span class="st">"Moderate-cover shrubland"</span>,</span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High-cover shrubland"</span>, <span class="st">"High-cover alfa grass steppe"</span></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a>covertype_plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro) <span class="sc">+</span></span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(cover_type, custom_order),</span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> label_value</span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylab, <span class="at">title =</span> <span class="st">"Vegetation cover (%)"</span>) <span class="sc">+</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rpas</span>() <span class="sc">+</span></span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_groups, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">80</span>,</span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RMSE&lt;sub&gt;norm.&lt;/sub&gt; = "</span>,</span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(rmsen.minmax, <span class="dv">2</span>), <span class="st">" %"</span></span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a>     <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(</span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> formula,</span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(adj.rr.label), <span class="st">"*</span><span class="sc">\"</span><span class="st">; </span><span class="sc">\"</span><span class="st">*"</span>,</span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a>      <span class="fu">after_stat</span>(p.value.label), <span class="st">"*</span><span class="sc">\"\"</span><span class="st">"</span>,</span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr.digits =</span> <span class="dv">3</span>,</span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt</span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_richtext</span>(</span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df.rmse_groups, <span class="at">size =</span> <span class="dv">8</span> <span class="sc">/</span> .pt,</span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">70</span>,</span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*R*&lt;sup&gt;2&lt;/sup&gt;&lt;sub&gt;predic.&lt;/sub&gt; = "</span>,</span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(pred.r2, <span class="dv">3</span>)</span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">label.color =</span> <span class="cn">NA</span></span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a>covertype_plot</span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> covertype_plot <span class="sc">/</span> treatment_plot <span class="sc">+</span></span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="sc">&amp;</span></span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb46-469"><a href="#cb46-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variance partitioning</span></span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a>Is the relationship between the vegetation coverage estimated by RPAS and by field measurement uniform across all coverage values? or is the correlation between those two approach homogeneous across all coverage values?</span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> partykit<span class="sc">::</span><span class="fu">ctree</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a><span class="fu">sctest</span>(ct)</span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a>There are 5 terminal nodes.</span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparty</span>(ct) <span class="sc">+</span></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge</span>() <span class="sc">+</span></span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_label</span>(<span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_plot</span>(</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">gglist =</span> <span class="fu">list</span>(</span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)),</span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas), <span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>),</span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"gray"</span>),</span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>),</span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab),</span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab)</span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"fixed"</span>,</span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_axis_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_separator =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"terminal"</span></span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">col =</span> splitvar),</span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_list =</span> <span class="fu">list</span>(</span>
<span id="cb46-508"><a href="#cb46-508" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Node"</span>, id)),</span>
<span id="cb46-509"><a href="#cb46-509" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> splitvar),</span>
<span id="cb46-510"><a href="#cb46-510" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value,</span>
<span id="cb46-511"><a href="#cb46-511" aria-hidden="true" tabindex="-1"></a>        <span class="at">accuracy =</span> <span class="fl">0.001</span>,</span>
<span id="cb46-512"><a href="#cb46-512" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimal.mark =</span> <span class="st">"."</span>,</span>
<span id="cb46-513"><a href="#cb46-513" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_p =</span> <span class="cn">TRUE</span></span>
<span id="cb46-514"><a href="#cb46-514" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb46-515"><a href="#cb46-515" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-516"><a href="#cb46-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_gpar =</span> <span class="fu">list</span>(</span>
<span id="cb46-517"><a href="#cb46-517" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-518"><a href="#cb46-518" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb46-519"><a href="#cb46-519" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb46-520"><a href="#cb46-520" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-521"><a href="#cb46-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"inner"</span></span>
<span id="cb46-522"><a href="#cb46-522" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-523"><a href="#cb46-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Node "</span>, id, <span class="st">", (n= "</span>, nodesize, <span class="st">")"</span>)),</span>
<span id="cb46-524"><a href="#cb46-524" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb46-525"><a href="#cb46-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"terminal"</span>,</span>
<span id="cb46-526"><a href="#cb46-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb46-527"><a href="#cb46-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="fl">0.01</span></span>
<span id="cb46-528"><a href="#cb46-528" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-529"><a href="#cb46-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb46-530"><a href="#cb46-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-531"><a href="#cb46-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-532"><a href="#cb46-532" aria-hidden="true" tabindex="-1"></a>What about the overfitting?</span>
<span id="cb46-533"><a href="#cb46-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-536"><a href="#cb46-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-537"><a href="#cb46-537" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas)) <span class="sc">+</span></span>
<span id="cb46-538"><a href="#cb46-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-539"><a href="#cb46-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-540"><a href="#cb46-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-541"><a href="#cb46-541" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">13</span>)),</span>
<span id="cb46-542"><a href="#cb46-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-543"><a href="#cb46-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb46-544"><a href="#cb46-544" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-545"><a href="#cb46-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-546"><a href="#cb46-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">23</span>)),</span>
<span id="cb46-547"><a href="#cb46-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-548"><a href="#cb46-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb46-549"><a href="#cb46-549" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-550"><a href="#cb46-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-551"><a href="#cb46-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">23</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">36</span>)),</span>
<span id="cb46-552"><a href="#cb46-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-553"><a href="#cb46-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb46-554"><a href="#cb46-554" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-555"><a href="#cb46-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-556"><a href="#cb46-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">36</span> <span class="sc">&amp;</span> plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">50</span>)),</span>
<span id="cb46-557"><a href="#cb46-557" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-558"><a href="#cb46-558" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb46-559"><a href="#cb46-559" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-560"><a href="#cb46-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-561"><a href="#cb46-561" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_coverage_field <span class="sc">&gt;</span> <span class="dv">50</span>)),</span>
<span id="cb46-562"><a href="#cb46-562" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-563"><a href="#cb46-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span></span>
<span id="cb46-564"><a href="#cb46-564" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-565"><a href="#cb46-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-566"><a href="#cb46-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-567"><a href="#cb46-567" aria-hidden="true" tabindex="-1"></a><span class="fu">### Find the optimous complexity parameter</span></span>
<span id="cb46-568"><a href="#cb46-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-571"><a href="#cb46-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-572"><a href="#cb46-572" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-573"><a href="#cb46-573" aria-hidden="true" tabindex="-1"></a>ctrpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb46-574"><a href="#cb46-574" aria-hidden="true" tabindex="-1"></a>ctrpart</span>
<span id="cb46-575"><a href="#cb46-575" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(ctrpart)</span>
<span id="cb46-576"><a href="#cb46-576" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(ctrpart)</span>
<span id="cb46-577"><a href="#cb46-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-578"><a href="#cb46-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-581"><a href="#cb46-581" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-582"><a href="#cb46-582" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-583"><a href="#cb46-583" aria-hidden="true" tabindex="-1"></a>ctrpart2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field,</span>
<span id="cb46-584"><a href="#cb46-584" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df, <span class="at">control =</span></span>
<span id="cb46-585"><a href="#cb46-585" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> .<span class="dv">075</span>)</span>
<span id="cb46-586"><a href="#cb46-586" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-587"><a href="#cb46-587" aria-hidden="true" tabindex="-1"></a>ctrpart2</span>
<span id="cb46-588"><a href="#cb46-588" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(ctrpart2)</span>
<span id="cb46-589"><a href="#cb46-589" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(ctrpart2)</span>
<span id="cb46-590"><a href="#cb46-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-591"><a href="#cb46-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-594"><a href="#cb46-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-595"><a href="#cb46-595" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-596"><a href="#cb46-596" aria-hidden="true" tabindex="-1"></a>ct_ok <span class="ot">&lt;-</span> partykit<span class="sc">::</span><span class="fu">ctree</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field,</span>
<span id="cb46-597"><a href="#cb46-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb46-598"><a href="#cb46-598" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span></span>
<span id="cb46-599"><a href="#cb46-599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ctree_control</span>(<span class="at">minsplit =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">maxdepth =</span> <span class="dv">1</span>)</span>
<span id="cb46-600"><a href="#cb46-600" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-601"><a href="#cb46-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-602"><a href="#cb46-602" aria-hidden="true" tabindex="-1"></a>plot_party <span class="ot">&lt;-</span> <span class="fu">ggparty</span>(ct_ok) <span class="sc">+</span></span>
<span id="cb46-603"><a href="#cb46-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge</span>() <span class="sc">+</span></span>
<span id="cb46-604"><a href="#cb46-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_label</span>(<span class="at">colour =</span> verde_oscuro, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb46-605"><a href="#cb46-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_plot</span>(</span>
<span id="cb46-606"><a href="#cb46-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">gglist =</span> <span class="fu">list</span>(</span>
<span id="cb46-607"><a href="#cb46-607" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(</span>
<span id="cb46-608"><a href="#cb46-608" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb46-609"><a href="#cb46-609" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> plant_coverage_field,</span>
<span id="cb46-610"><a href="#cb46-610" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> plant_coverage_rpas</span>
<span id="cb46-611"><a href="#cb46-611" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb46-612"><a href="#cb46-612" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">colour =</span> verde_oscuro</span>
<span id="cb46-613"><a href="#cb46-613" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-614"><a href="#cb46-614" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant_coverage_field, <span class="at">y =</span> plant_coverage_rpas),</span>
<span id="cb46-615"><a href="#cb46-615" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"gray"</span></span>
<span id="cb46-616"><a href="#cb46-616" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb46-617"><a href="#cb46-617" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span> verde_oscuro),</span>
<span id="cb46-618"><a href="#cb46-618" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>),</span>
<span id="cb46-619"><a href="#cb46-619" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab),</span>
<span id="cb46-620"><a href="#cb46-620" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab),</span>
<span id="cb46-621"><a href="#cb46-621" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb46-622"><a href="#cb46-622" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb46-623"><a href="#cb46-623" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-624"><a href="#cb46-624" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-625"><a href="#cb46-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"fixed"</span>,</span>
<span id="cb46-626"><a href="#cb46-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_axis_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-627"><a href="#cb46-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-628"><a href="#cb46-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_separator =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-629"><a href="#cb46-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"terminal"</span></span>
<span id="cb46-630"><a href="#cb46-630" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-631"><a href="#cb46-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">col =</span> splitvar),</span>
<span id="cb46-632"><a href="#cb46-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_list =</span> <span class="fu">list</span>(</span>
<span id="cb46-633"><a href="#cb46-633" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(id),</span>
<span id="cb46-634"><a href="#cb46-634" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">"Vegetation cover"</span>),</span>
<span id="cb46-635"><a href="#cb46-635" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value,</span>
<span id="cb46-636"><a href="#cb46-636" aria-hidden="true" tabindex="-1"></a>        <span class="at">accuracy =</span> <span class="fl">0.001</span>,</span>
<span id="cb46-637"><a href="#cb46-637" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimal.mark =</span> <span class="st">"."</span>,</span>
<span id="cb46-638"><a href="#cb46-638" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_p =</span> <span class="cn">TRUE</span></span>
<span id="cb46-639"><a href="#cb46-639" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb46-640"><a href="#cb46-640" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-641"><a href="#cb46-641" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_gpar =</span> <span class="fu">list</span>(</span>
<span id="cb46-642"><a href="#cb46-642" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>),</span>
<span id="cb46-643"><a href="#cb46-643" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>),</span>
<span id="cb46-644"><a href="#cb46-644" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb46-645"><a href="#cb46-645" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-646"><a href="#cb46-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"inner"</span>,</span>
<span id="cb46-647"><a href="#cb46-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.col =</span> verde_oscuro</span>
<span id="cb46-648"><a href="#cb46-648" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-649"><a href="#cb46-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"n = "</span>, nodesize)),</span>
<span id="cb46-650"><a href="#cb46-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="st">"terminal"</span>,</span>
<span id="cb46-651"><a href="#cb46-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb46-652"><a href="#cb46-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="fl">0.01</span></span>
<span id="cb46-653"><a href="#cb46-653" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-654"><a href="#cb46-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb46-655"><a href="#cb46-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-656"><a href="#cb46-656" aria-hidden="true" tabindex="-1"></a>plot_party</span>
<span id="cb46-657"><a href="#cb46-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-658"><a href="#cb46-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-659"><a href="#cb46-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-662"><a href="#cb46-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-663"><a href="#cb46-663" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-664"><a href="#cb46-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cover_vp =</span> <span class="fu">case_when</span>(</span>
<span id="cb46-665"><a href="#cb46-665" aria-hidden="true" tabindex="-1"></a>    plant_coverage_field <span class="sc">&lt;=</span> <span class="dv">36</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="st">"cob_low"</span>),</span>
<span id="cb46-666"><a href="#cb46-666" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"cob_high"</span></span>
<span id="cb46-667"><a href="#cb46-667" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb46-668"><a href="#cb46-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-669"><a href="#cb46-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-672"><a href="#cb46-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-673"><a href="#cb46-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rmse-vp</span></span>
<span id="cb46-674"><a href="#cb46-674" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-675"><a href="#cb46-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cover_vp) <span class="sc">%&gt;%</span></span>
<span id="cb46-676"><a href="#cb46-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-677"><a href="#cb46-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">round</span>(</span>
<span id="cb46-678"><a href="#cb46-678" aria-hidden="true" tabindex="-1"></a>      Metrics<span class="sc">::</span><span class="fu">rmse</span>(plant_coverage_field, plant_coverage_rpas), <span class="dv">4</span></span>
<span id="cb46-679"><a href="#cb46-679" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-680"><a href="#cb46-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(plant_coverage_field),</span>
<span id="cb46-681"><a href="#cb46-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(plant_coverage_field),</span>
<span id="cb46-682"><a href="#cb46-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsen.minmax =</span> rmse <span class="sc">/</span> (<span class="fu">max</span>(plant_coverage_field) <span class="sc">-</span> <span class="fu">min</span>(plant_coverage_field)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-683"><a href="#cb46-683" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-684"><a href="#cb46-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-685"><a href="#cb46-685" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predictive R2</span></span>
<span id="cb46-686"><a href="#cb46-686" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="ot">&lt;-</span> </span>
<span id="cb46-687"><a href="#cb46-687" aria-hidden="true" tabindex="-1"></a>  df.rmse_vp <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(</span>
<span id="cb46-688"><a href="#cb46-688" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(cover_vp) <span class="sc">|&gt;</span> </span>
<span id="cb46-689"><a href="#cb46-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-690"><a href="#cb46-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred.r2 =</span> <span class="fu">abs</span>(<span class="fu">pred_r_squared</span>(</span>
<span id="cb46-691"><a href="#cb46-691" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> .x)))))</span>
<span id="cb46-692"><a href="#cb46-692" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-693"><a href="#cb46-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-694"><a href="#cb46-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-695"><a href="#cb46-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-696"><a href="#cb46-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-699"><a href="#cb46-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-700"><a href="#cb46-700" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tab-rmse-vp</span></span>
<span id="cb46-701"><a href="#cb46-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: RMSE and normalized RMSE values for the correlation between the vegetation coverage estimates using RPAS *vs* Field measures. Values by variance partitioning-groups.</span></span>
<span id="cb46-702"><a href="#cb46-702" aria-hidden="true" tabindex="-1"></a>df.rmse_vp <span class="sc">%&gt;%</span></span>
<span id="cb46-703"><a href="#cb46-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb46-704"><a href="#cb46-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Groups Variance partitioning"</span>, <span class="st">"RMSE"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"norm. RMSE (%)"</span>, <span class="st">"pred R2"</span>),</span>
<span id="cb46-705"><a href="#cb46-705" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb46-706"><a href="#cb46-706" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-707"><a href="#cb46-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>()</span>
<span id="cb46-708"><a href="#cb46-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-709"><a href="#cb46-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-710"><a href="#cb46-710" aria-hidden="true" tabindex="-1"></a><span class="fu"># Is the the estimation influenced by other variables?</span></span>
<span id="cb46-711"><a href="#cb46-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-714"><a href="#cb46-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-715"><a href="#cb46-715" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_coverage_rpas <span class="sc">~</span> plant_coverage_field, <span class="at">data =</span> df)</span>
<span id="cb46-716"><a href="#cb46-716" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-717"><a href="#cb46-717" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">add_residuals</span>(m) <span class="sc">%&gt;%</span></span>
<span id="cb46-718"><a href="#cb46-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid.abs =</span> <span class="fu">abs</span>(resid))</span>
<span id="cb46-719"><a href="#cb46-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-720"><a href="#cb46-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-721"><a href="#cb46-721" aria-hidden="true" tabindex="-1"></a>dfres <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb46-722"><a href="#cb46-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abs.Shannon =</span> <span class="fu">abs</span>(shannon)) <span class="sc">%&gt;%</span></span>
<span id="cb46-723"><a href="#cb46-723" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb46-724"><a href="#cb46-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon =</span> abs.Shannon,</span>
<span id="cb46-725"><a href="#cb46-725" aria-hidden="true" tabindex="-1"></a>    <span class="at">Richness =</span> richness, <span class="at">Slope =</span> slope, resid, resid.abs</span>
<span id="cb46-726"><a href="#cb46-726" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-727"><a href="#cb46-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Shannon"</span>, <span class="st">"Richness"</span>, <span class="st">"Slope"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-728"><a href="#cb46-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">fct_relevel</span>(name, <span class="fu">c</span>(<span class="st">"Shannon"</span>, <span class="st">"Richness"</span>, <span class="st">"Slope"</span>)))</span>
<span id="cb46-729"><a href="#cb46-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-730"><a href="#cb46-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-733"><a href="#cb46-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-734"><a href="#cb46-734" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggscatter</span>(dfres,</span>
<span id="cb46-735"><a href="#cb46-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"value"</span>, <span class="at">y =</span> <span class="st">"resid.abs"</span>,</span>
<span id="cb46-736"><a href="#cb46-736" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> verde_oscuro,</span>
<span id="cb46-737"><a href="#cb46-737" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb46-738"><a href="#cb46-738" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb46-739"><a href="#cb46-739" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"|"</span>, <span class="st">"Residuals"</span>, <span class="st">"|"</span>)),</span>
<span id="cb46-740"><a href="#cb46-740" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">"reg.line"</span>,</span>
<span id="cb46-741"><a href="#cb46-741" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> verde_oscuro, <span class="at">fill =</span> verde_claro),</span>
<span id="cb46-742"><a href="#cb46-742" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-743"><a href="#cb46-743" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.by =</span> <span class="st">"variable"</span></span>
<span id="cb46-744"><a href="#cb46-744" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb46-745"><a href="#cb46-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb46-746"><a href="#cb46-746" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y.npc =</span> <span class="st">"top"</span>, <span class="at">label.x.npc =</span> <span class="st">"left"</span>,</span>
<span id="cb46-747"><a href="#cb46-747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb46-748"><a href="#cb46-748" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> verde_oscuro, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb46-749"><a href="#cb46-749" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-750"><a href="#cb46-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb46-751"><a href="#cb46-751" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(</span>
<span id="cb46-752"><a href="#cb46-752" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> verde_oscuro,</span>
<span id="cb46-753"><a href="#cb46-753" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span></span>
<span id="cb46-754"><a href="#cb46-754" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-755"><a href="#cb46-755" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb46-756"><a href="#cb46-756" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> verde_oscuro,</span>
<span id="cb46-757"><a href="#cb46-757" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span></span>
<span id="cb46-758"><a href="#cb46-758" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-759"><a href="#cb46-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb46-760"><a href="#cb46-760" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-761"><a href="#cb46-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-762"><a href="#cb46-762" aria-hidden="true" tabindex="-1"></a>p.resid <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">facet</span>(p,</span>
<span id="cb46-763"><a href="#cb46-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.by =</span> <span class="st">"variable"</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb46-764"><a href="#cb46-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.labs.background =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb46-765"><a href="#cb46-765" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-766"><a href="#cb46-766" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb46-767"><a href="#cb46-767" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-768"><a href="#cb46-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-769"><a href="#cb46-769" aria-hidden="true" tabindex="-1"></a>p.resid</span>
<span id="cb46-770"><a href="#cb46-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-771"><a href="#cb46-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-774"><a href="#cb46-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-775"><a href="#cb46-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb46-776"><a href="#cb46-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: generate-jpg</span></span>
<span id="cb46-777"><a href="#cb46-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-778"><a href="#cb46-778" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(general_plot,</span>
<span id="cb46-779"><a href="#cb46-779" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_general.jpg"</span>),</span>
<span id="cb46-780"><a href="#cb46-780" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-781"><a href="#cb46-781" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-782"><a href="#cb46-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-783"><a href="#cb46-783" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(treatment_plot,</span>
<span id="cb46-784"><a href="#cb46-784" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_treatment.jpg"</span>),</span>
<span id="cb46-785"><a href="#cb46-785" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-786"><a href="#cb46-786" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-787"><a href="#cb46-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-788"><a href="#cb46-788" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(covertype_plot,</span>
<span id="cb46-789"><a href="#cb46-789" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_covertype.jpg"</span>),</span>
<span id="cb46-790"><a href="#cb46-790" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">15</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-791"><a href="#cb46-791" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-792"><a href="#cb46-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-793"><a href="#cb46-793" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_plot,</span>
<span id="cb46-794"><a href="#cb46-794" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_combined.jpg"</span>),</span>
<span id="cb46-795"><a href="#cb46-795" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-796"><a href="#cb46-796" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-797"><a href="#cb46-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-798"><a href="#cb46-798" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(p.resid,</span>
<span id="cb46-799"><a href="#cb46-799" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/residuals.jpg"</span>),</span>
<span id="cb46-800"><a href="#cb46-800" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-801"><a href="#cb46-801" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-802"><a href="#cb46-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-803"><a href="#cb46-803" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_party,</span>
<span id="cb46-804"><a href="#cb46-804" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_partitioning.jpg"</span>),</span>
<span id="cb46-805"><a href="#cb46-805" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"jpg"</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>, <span class="at">bg =</span> <span class="st">"white"</span></span>
<span id="cb46-806"><a href="#cb46-806" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-807"><a href="#cb46-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-808"><a href="#cb46-808" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_party,</span>
<span id="cb46-809"><a href="#cb46-809" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_partitioning.svg"</span>),</span>
<span id="cb46-810"><a href="#cb46-810" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>, <span class="at">bg =</span> <span class="st">"white"</span></span>
<span id="cb46-811"><a href="#cb46-811" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-812"><a href="#cb46-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-813"><a href="#cb46-813" aria-hidden="true" tabindex="-1"></a><span class="co"># PNG devices</span></span>
<span id="cb46-814"><a href="#cb46-814" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(general_plot,</span>
<span id="cb46-815"><a href="#cb46-815" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_general_transp.png"</span>),</span>
<span id="cb46-816"><a href="#cb46-816" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-817"><a href="#cb46-817" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-818"><a href="#cb46-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-819"><a href="#cb46-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-820"><a href="#cb46-820" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(treatment_plot,</span>
<span id="cb46-821"><a href="#cb46-821" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_treatment_transp.png"</span>),</span>
<span id="cb46-822"><a href="#cb46-822" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-823"><a href="#cb46-823" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-824"><a href="#cb46-824" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-825"><a href="#cb46-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-826"><a href="#cb46-826" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(covertype_plot,</span>
<span id="cb46-827"><a href="#cb46-827" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_covertype_transp.png"</span>),</span>
<span id="cb46-828"><a href="#cb46-828" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">15</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-829"><a href="#cb46-829" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-830"><a href="#cb46-830" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-831"><a href="#cb46-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-832"><a href="#cb46-832" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_plot,</span>
<span id="cb46-833"><a href="#cb46-833" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_combined.png"</span>),</span>
<span id="cb46-834"><a href="#cb46-834" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-835"><a href="#cb46-835" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-836"><a href="#cb46-836" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-837"><a href="#cb46-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-838"><a href="#cb46-838" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(p.resid,</span>
<span id="cb46-839"><a href="#cb46-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/residuals.png"</span>),</span>
<span id="cb46-840"><a href="#cb46-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-841"><a href="#cb46-841" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-842"><a href="#cb46-842" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-843"><a href="#cb46-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-844"><a href="#cb46-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-845"><a href="#cb46-845" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_party,</span>
<span id="cb46-846"><a href="#cb46-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_partitioning.jpg"</span>),</span>
<span id="cb46-847"><a href="#cb46-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>,</span>
<span id="cb46-848"><a href="#cb46-848" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">"transparent"</span></span>
<span id="cb46-849"><a href="#cb46-849" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-850"><a href="#cb46-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-851"><a href="#cb46-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-852"><a href="#cb46-852" aria-hidden="true" tabindex="-1"></a><span class="do">##  SVG</span></span>
<span id="cb46-853"><a href="#cb46-853" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(general_plot,</span>
<span id="cb46-854"><a href="#cb46-854" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_general.svg"</span>),</span>
<span id="cb46-855"><a href="#cb46-855" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-856"><a href="#cb46-856" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-857"><a href="#cb46-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-858"><a href="#cb46-858" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(treatment_plot,</span>
<span id="cb46-859"><a href="#cb46-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_treatment.svg"</span>),</span>
<span id="cb46-860"><a href="#cb46-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-861"><a href="#cb46-861" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-862"><a href="#cb46-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-863"><a href="#cb46-863" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(covertype_plot,</span>
<span id="cb46-864"><a href="#cb46-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_covertype.svg"</span>),</span>
<span id="cb46-865"><a href="#cb46-865" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">15</span>, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-866"><a href="#cb46-866" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-867"><a href="#cb46-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-868"><a href="#cb46-868" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_plot,</span>
<span id="cb46-869"><a href="#cb46-869" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_combined.svg"</span>),</span>
<span id="cb46-870"><a href="#cb46-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-871"><a href="#cb46-871" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-872"><a href="#cb46-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-873"><a href="#cb46-873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(p.resid,</span>
<span id="cb46-874"><a href="#cb46-874" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/residuals.svg"</span>),</span>
<span id="cb46-875"><a href="#cb46-875" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span></span>
<span id="cb46-876"><a href="#cb46-876" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-877"><a href="#cb46-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-878"><a href="#cb46-878" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_party,</span>
<span id="cb46-879"><a href="#cb46-879" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output/correla_partitioning.svg"</span>),</span>
<span id="cb46-880"><a href="#cb46-880" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">"svg"</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">unit =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="st">"print"</span>, <span class="at">bg =</span> <span class="st">"white"</span></span>
<span id="cb46-881"><a href="#cb46-881" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-882"><a href="#cb46-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-883"><a href="#cb46-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-884"><a href="#cb46-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>